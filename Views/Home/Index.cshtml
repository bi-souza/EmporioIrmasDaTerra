@model IEnumerable<EmporioIrmasDaTerra.Models.Produto>

@{
    ViewData["Title"] = "Página Inicial";
}

@*<div class="hero-banner my-4">
</div>*@
<link rel="stylesheet" href="~/css/style.css">

@section Scripts {
<script>
    $(document).ready(function() {
        // Seleciona todos os itens do carrossel que têm o atributo data-categoria-url
        $('.carousel-item').on('click', function(event) {
            
            // Verifica se o clique NÃO foi no botão (ou em qualquer elemento dentro da legenda)
            // Isso evita o clique duplo, garantindo que o botão funcione normalmente.
            if (!$(event.target).closest('.carousel-caption').length) {
                
                // Pega o slug da categoria do atributo data-
                var categoriaSlug = $(this).data('categoria-url');
                
                if (categoriaSlug) {
                    // Monta a URL (AQUI é onde a mágica acontece)
                    var url = '@Url.Action("PorCategoria", "Produtos")' + '?categoria=' + categoriaSlug;
                    
                    // Redireciona
                    window.location.href = url;
                }
            }
        });
    });
</script>
}


<div class="container mt-5">
    <div id="carouselExampleCaptions" class="carousel slide mb-5" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3" aria-label="Slide 4"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="4" aria-label="Slide 5"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="5" aria-label="Slide 6"></button>
        </div>

        <div class="carousel-inner">
            
            <div class="carousel-item active" data-categoria-url="temperos">
                <img src="/images/banner1.jpg" class="d-block w-100" alt="Promoção de Temperos Naturais">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Temperos Naturais</h5>
                    <p>Realce o sabor dos seus pratos com nossos produtos 100% naturais.</p>
                    <a asp-controller="Produtos" asp-action="PorCategoria" asp-route-categoria="temperos" class="btn btn-carousel-cta">Ver Produtos</a> 
                </div>
            </div>
            
            <div class="carousel-item" data-categoria-url="chas">
                <img src="/images/banner2.jpg" class="d-block w-100" alt="Chás e Infusões">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Chás e Infusões</h5>
                    <p>Relaxe e cuide da sua saúde com blends especiais.</p>
                    <a asp-controller="Produtos" asp-action="PorCategoria" asp-route-categoria="chas" class="btn btn-carousel-cta">Ver Produtos</a>
                </div>
            </div>
            
            <div class="carousel-item" data-categoria-url="queijos">
                <img src="/images/banner3.jpg" class="d-block w-100" alt="Queijos e Laticínios Artesanais">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Queijos Artesanais</h5>
                    <p>Sabor e qualidade direto do campo para sua mesa.</p>
                    <a asp-controller="Produtos" asp-action="PorCategoria" asp-route-categoria="queijos" class="btn btn-carousel-cta">Ver Produtos</a>
                </div>
            </div>
            
            <div class="carousel-item" data-categoria-url="suplementos">
                <img src="/images/banner4.jpg" class="d-block w-100" alt="Suplementos">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Saúde e Bem-Estar</h5>
                    <p>Nutrição completa para seu corpo e sua rotina diária.</p>
                    <a asp-controller="Produtos" asp-action="PorCategoria" asp-route-categoria="suplementos" class="btn btn-carousel-cta">Ver Produtos</a>
                </div>
            </div>
            
            <div class="carousel-item" data-categoria-url="vinhos">
                <img src="/images/banner5.jpg" class="d-block w-100" alt="Vinhos e Bebidas">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Seleção de Bebidas</h5>
                    <p>Rótulos especiais e bebidas artesanais para celebrar momentos.</p>
                    <a asp-controller="Produtos" asp-action="PorCategoria" asp-route-categoria="vinhos" class="btn btn-carousel-cta">Ver Produtos</a>
                </div>
            </div>
            
            <div class="carousel-item" data-categoria-url="graos">
                <img src="/images/banner6.jpg" class="d-block w-100" alt="Grãos e Cereais">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Grãos e Cereais</h5>
                    <p>Ingredientes nutritivos para uma alimentação equilibrada.</p>
                    <a asp-controller="Produtos" asp-action="PorCategoria" asp-route-categoria="graos" class="btn btn-carousel-cta">Ver Produtos</a>
                </div>
            </div>
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Próximo</span>
        </button>
    </div>

    <div class="row mb-3">
        <div class="col">
            <h2>MAIS VENDIDOS <span style="color: var(--cor-cinza-escuro); font-weight: 300;"></span></h2>
        </div>
    </div>

    <div class="row">
        @if (Model.Any())
        {
            @foreach (var produto in Model)
            {
                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="card product-card h-100">
                        
                        @{
                            var imagePath = string.IsNullOrEmpty(produto.ImagemUrl) 
                                                                ? "/images/placeholder-produto.jpg" 
                                                                : produto.ImagemUrl;
                        }
                        <img src="@imagePath" class="card-img-top" alt="@produto.NomeProduto">
                        
                        <div class="card-body">
                            <h5 class="card-title">@produto.NomeProduto</h5>
                            
                            <div class="product-stars">
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star-half-alt"></i>
                                <span class="text-muted" style="font-size: 0.8rem;">(4.5)</span>
                            </div>

                            <h4 style="color: var(--cor-verde-floresta);">R$ @produto.Preco.ToString("F2")</h4>

                            <a asp-controller="Produtos" 
                            asp-action="Detalhes" 
                            asp-route-id="@produto.IdProduto" 
                            class="btn btn-outline-primary w-100">
                            Ver Detalhes
                            </a>

                            <a href="#" class="btn btn-primary w-100 mt-2">
                                <i class="fa fa-shopping-cart"></i> Comprar
                            </a>
                        </div>
                        
                    </div>
                </div>
            }
        }
        else
        {
            <div class="col-12">
                <p>Nenhum produto em destaque no momento.</p>
            </div>
        }
    </div>